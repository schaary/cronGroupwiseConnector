#!/usr/bin/env ruby
# encoding: utf-8

require 'chronic'
require 'dotenv'
require 'ruby-plsql'
require 'thor'

class Notify < Thor
  desc 'send_add_sets','fetch the cursor with new mail addresss from idm'
  def send_add_sets
    fetch
  end

private
  def fetch
    connect
    puts plsql.accounts.count
  end

  def lastRun
  end


  def connect
    Dotenv.load

    plsql.connection = OCI8.new \
      ENV['IDM_USERNAME'],
      ENV['IDM_PASSWORD'],
      ENV['IDM_SID']
  end
end

Notify.start
